# Files

- `docker_image`: The docker image used for evaluation.
    - `docker_image_files`: File system structure and scripts used for the docker image.
    - `docker_image.tar.xz`: The image.
    - `run_image.sh`: Script for running the image. Requires OpenAI credentials.

- `emse_projects.tar.xz`: The benchmark projects.
- `emse_projects_data`: Extra data for the benchmark projects.
    - `mutants_original`: Mutants, as generated by `cosmic-ray`.
    - `mutants_sampled`: Sampled mutants.
    - `requirements`: Dependencies for each project.
    - `scripts`: Various scripts for preparing the benchmarks, as well info about the projects' packages and their paths.
    - `dependency_adjustments.txt`: List of adjusted dependencies for the benchmark projects.
    - `excluded_mutants.txt`: List of excluded mutants and error logs.
    - `packages.txt`: PyPI packages of the benchmark projects.
    - `selected_projects.txt`: List of selected projects.

- `guut`: Implementation of our approaches.
    - `guut/templates`: Prompt templates.
    - `scipts`: A few helper scripts

- `guut_emse_results.tar.xz`: Results of running our approaches.
    - Each directory represents running one approach on one project.
    - Files for each run:
        - `cosmic-ray`: Results of running mutation testing, stopping early when a test fails.
        - `cosmic-ray-full`: Results of running mutation testing, without stopping early.
            - `failing_tests.json`: List of tests that failed during flaky test detection.
            - `mutants.sqlite`: Results of mutation testing.
        - `coverage`: Results of running the tests with coverage.
        - `loops`: Data for each target mutant.
            - Files for each mutant:
                - `conversation.{json,md,txt}`: Conversation loop with the LLM.
                - `result.json`: Result file containing, among other info, details about each experiment and test.
                - `test.py`: Generated tests. Missing if no killing tests was found for a mutant.
        - `tests`: Output test suite.
        - `result.json`: Summary of mutants and tests.

- `other_data`
    - `failing_tests.json`: Aggregated failing tests from flaky test detection.
    - `guut_loc_per_test.json`: LOC of each generated tests, measured with `scc`.
    - `pynguin_excluded_runs.txt`: Info about excluded Pynguin results.
    - `pynguin_failing_tests.json`: Pynguin's failing tests from flaky tests detection.
    - `pynguin_loc_per_test_file.json`: LOC for each Pynguin test file.
    - `pynguin_loc_per_test_file_minimized_{combined,individual}.json`: LOC for each Pynguin test file of minimized test suites.
    - `pynguin_minimized_tests_{combined,individual}.json`: Tests for minimized Pynguin test suites.

- `pynguin_emse_tests.tar.xz`
    - Generated Pynguin tests, sorted by project and index of run.
- `pynguin_emse_results.tar.xz`
    - Unedited Pynguin results.

- `samlples`
    - `examples`: Example mutants used in the Paper.
    - `tests`: Tests with execution results for all sampled mutants.
    - `inspect_mutant.sh`, `neovide_instance.sh`: Scripts for checking the sampled mutants.
    - `killed_mutants.txt`: Explanation for sampled mutants that later turned out to be killable.
    - `rules.txt`: Rules for what counts and doesn't count as quasi-equivalent.
    - `sampled_mutants.csv`: Sampled mutants with equivalence status and added comments.

- `scripts`
    - `agg_failing_tests.sh`: Aggregates the flaky tests from all runs.
    - `collect_pynguin_tests.py`: Sorts generated Pynguin test by project and run index.
    - `convert_notebook.py`: Converts `stats.py` into a Jupyter Notebook.
    - `count_loc.sh`: Counts LOC and sorts them by Python file.
    - `minimize_pynguin_test_files.py`: Minimizes Pynguin test suites by deleting all tests not contained in the minimized suite.
    - `stats.py`: Huge notebook containing all code for analyzing the evaluation results. In Zed REPL format.

# Approach Names

Our internal names for the four approaches map to the names used in the Paper like so:

- `debugging_one_shot`: "Scientific (1-shot)"
- `debugging_zero_shot`: "Scientific (0-shot)"
- `baseline_without_iterations`: "Baseline"
- `baseline_with_iterations`: "Iterative"

# Docker Image

## Setup

The image uses three docker volumes to manage data.

- `guut-emse-results`:
    Results of our approaches. Has the same folder structure as `guut_emse_results.tar.xz`.
    This is used as output when running our approaches, and as input when running mutation testing or coverage measurement.
    You can extract `guut_emse_results.tar.xz` directly into the volume root to work on the evaluation data.
- `guut-emse-logs`:
    Conversation logs for running our approaches.
    This was mostly used during development and can now be discarded, as the same info is replicated in results.
- `pynguin-emse-results`:
    Results of running Pynguin on the benchmark projects. Has the same folder structure as `pynguin_emse_tests.tar.xz`.
    This is used as input when running mutation testing or coverage measurement.
    You can extract `pynguin_emse_tests.tar.xz` directly into the volume root to work on the evaluation data.

## Running the image

Use `docker_image/run_image.sh` to run the image.
First, replace the `OPENAI_API_KEY` and `OPENAI_ORGANIZATION` (optional) constants in the script.

The docker image lists the available options when called. E.g.

```bash
$ ./run_image.sh
Usage: entrypoint.sh SCRIPT_NAME
Available scripts:
  run_cosmic_ray
  run_coverage
  run_emse_benchmark
  run_pynguin_cosmic_ray
  run_pynguin_coverage
```

```bash
$ ./run_image.sh run_cosmic_ray
Usage: run_cosmic_ray.sh RESULT_ID EMSE_PROJECT_NAME [--continue] [-x]

$ ./run_image.sh run_coverage
Usage: run_coverage.sh RESULT_ID EMSE_PROJECT_NAME

$ ./run_image.sh run_emse_benchmark
Usage: run_emse_benchmark.sh PRESET_NAME EMSE_PROJECT_NAME

$ ./run_image.sh run_pynguin_cosmic_ray
Usage: run_pynguin_cosmic_ray.sh EMSE_PROJECT_NAME RESULT_NUM

$ ./run_image.sh run_pynguin_coverage
Usage: run_pynguin_coverage.sh EMSE_PROJECT_NAME RESULT_NUM
```

Arguments explanation:
- `RESULT_ID`: Refers to the run's folder name as listed in `guut_emse_results.tar.xz`.
- `EMSE_PROJECT_NAME`: Refers to the projects's name as listed in `emse_projects.tar.xz`.
- `PRESET_NAME`: Refers to the internal approach name, as listed in the "Approach Names" section.
- `RESULT_NUM`: Refers to the index of a Pynguin run, as listed in `pynguin_emse_tests.tar.xz`.
- `--continue`: Continues a started run.
- `-x`: Stops at the first failed tests.
